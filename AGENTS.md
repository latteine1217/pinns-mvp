# é–‹ç™¼è€…æŒ‡å¼• ğŸ‘¨â€ğŸ’»

## ğŸ¯ è§’è‰²æ‰®æ¼”æº–å‰‡
> ç•¶åŸ·è¡Œå°ˆæ¡ˆä»»å‹™æ™‚ï¼Œè«‹æ‰®æ¼”ä¸€ä½è³‡æ·±çš„artificial intellegence engineerï¼Œå…·å‚™ä»¥ä¸‹ç‰¹è³ªï¼š
> - å°ˆç²¾pythonèªè¨€ï¼Œå°¤å…¶æ“…é•·ä½¿ç”¨pytorchè¨­è¨ˆç¶²è·¯æ¶æ§‹
> - ğŸ” **é¡å‹å®‰å…¨å„ªå…ˆ**
> - âš¡ **æ•ˆèƒ½å°å‘**
> - ğŸ§ª **æ¸¬è©¦é©…å‹•**: é‡è¦–ç¨‹å¼ç¢¼å“è³ªï¼Œæ¨å´‡æ–‡æª”è¦†è“‹
> - ğŸ”„ **ç°¡æ½”æ¶æ§‹**
> - ä»”ç´°æ€è€ƒï¼ŒåªåŸ·è¡Œæˆ‘çµ¦ä½ çš„å…·é«”ä»»å‹™ï¼Œç”¨æœ€ç°¡æ½”å„ªé›…çš„è§£æ±ºæ–¹æ¡ˆï¼Œç›¡å¯èƒ½å°‘çš„ä¿®æ”¹ç¨‹å¼ç¢¼

# å°ˆæ¡ˆç ”ç©¶é¡Œç›®
å°‘é‡è³‡æ–™ Ã— ç‰©ç†å…ˆé©—ï¼šåŸºæ–¼å…¬é–‹æ¹æµè³‡æ–™åº«çš„PINNsé€†é‡å»º
Sparse-Data, Physics-Informed Inversion on Public Turbulence Benchmarks: Reconstruction

# å°ˆæ¡ˆç›®æ¨™
æœ¬ç ”ç©¶è©¦è‘—å»ºç«‹ã€Œ**å°‘é‡è³‡æ–™é» Ã— ä½ä¿çœŸå¼•å° Ã— æºé …é‚„åŸ**ã€ä¹‹ PINNs é€†å•é¡Œæ¡†æ¶ï¼›ä»¥ JHTDB/UT Austin çš„æ¹æµè³‡æ–™ï¼ˆé€šé“æµ Re_\tau=1000)ç‚ºåŸºæº–å ´ï¼Œå¾ **Kï¼ˆâ‰¤30â€“80ï¼‰å€‹ç©ºé–“é»**èˆ‡/æˆ–çŸ­æ™‚é–“åºåˆ—å‡ºç™¼ï¼Œåœ¨**ä½ä¿çœŸå ´ï¼ˆRANSï¼ç²— LESï¼ä¸‹æ¡æ¨£ DNSï¼‰ä½œç‚ºè»Ÿå…ˆé©—ä¸‹ï¼Œé‡å»ºç¬æ™‚æˆ–çµ±è¨ˆç©©æ…‹çš„é€Ÿåº¦èˆ‡å£“åŠ›å ´**ã€‚

é‡åŒ–é–€æª»ä¿‚åƒè€ƒä¸‹åˆ—å·²è­‰å¯¦çš„é‡Œç¨‹ç¢‘èˆ‡æœ€æ–°é€²å±•è€Œåˆ¶å®šï¼š

- **ç¨€ç–è§€æ¸¬â†’å…¨å ´é‡å»ºèˆ‡å£“åŠ›å ´å¯æ¨å›**ï¼šä»¥ HFM/PINN è„ˆçµ¡è­‰å¯¦å¯ç”±ç¨€ç–å¯è¦–åŒ–/é€Ÿåº¦è³‡æ–™é‡å»ºé€Ÿåº¦èˆ‡å£“åŠ›ï¼ˆä½œç‚ºæœ¬ç ”ç©¶ã€Œå°‘é‡é»é‡å»ºã€çš„å¯è¡Œæ€§ä¸‹é™åƒè€ƒï¼‰
- **æ„Ÿæ¸¬é»é¸æ“‡èˆ‡ç©©å¥æ€§**ï¼šæ¡ç”¨ **QR-pivot æœ€é©æ„Ÿæ¸¬é…ç½®**ä½œç‚ºã€Œæœ€å°‘é»æ•¸ K ã€çš„è¨­è¨ˆèˆ‡é©—è­‰åŸºæº–ã€‚
- **è¨“ç·´æ•ˆç‡èˆ‡å‰›æ€§è™•ç†**ï¼šå¼•å…¥ **VS-PINNï¼ˆè®Šæ•¸å°ºåº¦åŒ–ï¼‰** èˆ‡å‹•æ…‹æ¬Šé‡ï¼Œå°‡å…¶ä½œç‚ºã€Œæ”¶æ–‚æ•ˆç‡ã€èˆ‡ã€Œç¡¬å•é¡Œç©©å®šåŒ–ã€çš„å¯é‡ç¾å¼·åŸºç·šã€‚
- **è³‡æ–™ä¾†æºèˆ‡é‡ç¾æ€§**ï¼šä½¿ç”¨ **JHTDB**ï¼ˆå®˜æ–¹å»ºè­°çš„ SciServer/pyJHTDB å–æ•¸è·¯å¾‘ï¼‰åšç‚ºé«˜ä¿çœŸåŸºæº–èˆ‡å°ç…§è³‡æ–™çš„æ¬Šå¨ä¾†æºã€‚

æ“šæ­¤èƒŒæ™¯è¨­å®šä»¥ä¸‹**å¯é©—è­‰æˆåŠŸé–€æª»**ï¼ˆå°æ‡‰ä¸Šåˆ—åŸºæº–çš„èƒ½åŠ›ï¼‰ï¼š

1. **æµå ´èª¤å·®**ï¼šé€Ÿåº¦/å£“åŠ›å ´ç›¸å° L2 error â‰¤ **10â€“15%**ï¼ˆä¾æ¡ˆä¾‹åˆ†å±¤ï¼‰ï¼Œä¸”ç›¸è¼ƒä½ä¿çœŸä¹‹**çµ±è¨ˆ/èƒ½è­œ/å£é¢å‰ªæ‡‰åŠ›**çš„ RMSE **ä¸‹é™ â‰¥30%**ï¼ˆå°é½Šã€Œä½â†’é«˜ä¿çœŸæ ¡æ­£ã€çš„ä¸»æµåšæ³•ï¼‰
2. **å¯è­˜åˆ¥æ€§ï¼ˆMPS, æœ€å°‘é»æ•¸ Kï¼‰**ï¼šåœ¨é‡æ¸¬å™ªè² **Ïƒ=1â€“3%**ã€éš¨æ©Ÿéºå¤± **10%** ä¸‹ï¼Œé”æ¨™é»æ•¸ **K â‰¤ 50**ï¼›Kâ€“èª¤å·®æ›²ç·šä»¥ **QR-pivot ä½ˆå±€**ç‚ºæœ€å°å¯è¡Œä¸Šç•Œçš„å°ç…§ç·š
3. **æ•ˆç‡/ç©©å¥**ï¼šç›¸è¼ƒå›ºå®šæ¬Šé‡åŸºç·šï¼Œæ¡ **VS-PINN + å‹•æ…‹æ¬Šé‡**ä½¿æ”¶æ–‚ epoch **ä¸‹é™ â‰¥30%**ï¼›UQ æ–¹å·®èˆ‡çœŸå¯¦èª¤å·®ç›¸é—œ **r â‰¥ 0.6**ï¼ˆä»¥ ensemble PINN é‡æ¸¬ï¼‰ã€‚
4. **è³‡æ–™é‡ç¾æ€§**ï¼šæ‰€æœ‰è©•æ¸¬ä»¥ **JHTDB cutout/æ•£é»å–æ¨£**ç‚ºæ¨™æº–æµç¨‹ï¼Œä¸¦éµå¾ªå®˜æ–¹å¼•ç”¨èˆ‡å†ç¾è¦ç¯„ã€‚

# ç›®éŒ„çµæ§‹ï¼ˆå¯¦éš›ï¼‰

```
pinns-mvp/
  â”œâ”€ configs/                      # è¨“ç·´é…ç½® (30+ YAML æª”æ¡ˆ)
  â”‚   â”œâ”€ defaults.yml              # é è¨­é…ç½®
  â”‚   â”œâ”€ channel_flow_*.yml        # é€šé“æµç³»åˆ—é…ç½®
  â”‚   â”œâ”€ vs_pinn_*.yml             # VS-PINN ç³»åˆ—é…ç½®
  â”‚   â”œâ”€ inverse_*.yml             # é€†å•é¡Œé…ç½®
  â”‚   â””â”€ curriculum_*.yml          # èª²ç¨‹å­¸ç¿’é…ç½®
  â”‚
  â”œâ”€ data/
  â”‚   â”œâ”€ lowfi/                    # RANS/ç²—LESï¼ˆNetCDF/HDF5/npzï¼‰
  â”‚   â””â”€ jhtdb/                    # é«˜ä¿çœŸ cutout/æ•£é»å–æ¨£å¿«å–
  â”‚
  â”œâ”€ scripts/                      # å¯åŸ·è¡Œè…³æœ¬ (30 æ ¸å¿ƒ + æ­¸æª”)
  â”‚   â”œâ”€ train.py â­               # ä¸»è¨“ç·´å™¨ï¼ˆæ”¯æ´ curriculumï¼‰
  â”‚   â”œâ”€ evaluate.py               # ä¸»è©•ä¼°è…³æœ¬
  â”‚   â”œâ”€ evaluate_checkpoint.py    # æª¢æŸ¥é»è©•ä¼°
  â”‚   â”œâ”€ evaluate_curriculum.py    # èª²ç¨‹å­¸ç¿’è©•ä¼°
  â”‚   â”œâ”€ comprehensive_evaluation.py # å®Œæ•´ç‰©ç†é©—è­‰è©•ä¼°
  â”‚   â”œâ”€ evaluate_3d_physics.py    # 3D ç‰©ç†å ´è©•ä¼°
  â”‚   â”‚
  â”‚   â”œâ”€ fetch_channel_flow.py     # JHTDB è³‡æ–™ç²å–
  â”‚   â”œâ”€ verify_jhtdb_data.py      # è³‡æ–™é©—è­‰
  â”‚   â”‚
  â”‚   â”œâ”€ visualize_results.py      # å¢å¼·è¦–è¦ºåŒ–å·¥å…·
  â”‚   â”œâ”€ visualize_adaptive_sampling.py # è‡ªé©æ‡‰æ¡æ¨£è¦–è¦ºåŒ–
  â”‚   â”œâ”€ generate_jhtdb_field_plots.py # JHTDB å ´åœ–ç”Ÿæˆ
  â”‚   â”‚
  â”‚   â”œâ”€ monitor_training_progress.py # é€šç”¨è¨“ç·´ç›£æ§
  â”‚   â”œâ”€ monitor_warmup_test.py    # Warmup ç›£æ§
  â”‚   â”œâ”€ monitor_curriculum.sh     # èª²ç¨‹å­¸ç¿’ç›£æ§è…³æœ¬
  â”‚   â”œâ”€ monitor_curriculum_ic.sh  # IC èª²ç¨‹ç›£æ§
  â”‚   â”‚
  â”‚   â”œâ”€ parameter_sensitivity_experiment.py # åƒæ•¸æ•æ„Ÿåº¦å¯¦é©—
  â”‚   â”œâ”€ k_scan_experiment.py      # K æƒæå¯¦é©—
  â”‚   â”œâ”€ analyze_k_scan.py         # K æƒæåˆ†æ
  â”‚   â”œâ”€ run_longterm_training.py  # é•·æœŸè¨“ç·´ç®¡ç†
  â”‚   â”œâ”€ benchmark.py              # æ€§èƒ½åŸºæº–æ¸¬è©¦
  â”‚   â”œâ”€ quick_benchmark.py        # å¿«é€ŸåŸºæº–æ¸¬è©¦
  â”‚   â”œâ”€ activation_benchmark.py   # æ¿€æ´»å‡½æ•¸æ¸¬è©¦
  â”‚   â”œâ”€ analyze_full_field_data.py # å…¨å ´è³‡æ–™åˆ†æ
  â”‚   â”œâ”€ detailed_field_analysis.py # è©³ç´°å ´åˆ†æ
  â”‚   â”œâ”€ diagnose_channel_flow_characteristics.py # é€šé“æµè¨ºæ–·
  â”‚   â”‚
  â”‚   â”œâ”€ validate_constraints.py   # ç´„æŸæ¢ä»¶é©—è­‰
  â”‚   â”œâ”€ verify_model_scaling.py   # æ¨¡å‹å°ºåº¦é©—è­‰
  â”‚   â”œâ”€ verify_weights.py         # æå¤±æ¬Šé‡é©—è­‰
  â”‚   â”‚
  â”‚   â”œâ”€ debug/                    # é™¤éŒ¯å·¥å…· (15 å€‹è¨ºæ–·è…³æœ¬)
  â”‚   â”‚   â”œâ”€ diagnose_ns_equations.py â­ # ä¸»è¦ NS æ–¹ç¨‹è¨ºæ–·
  â”‚   â”‚   â”œâ”€ diagnose_boundary_conditions.py
  â”‚   â”‚   â”œâ”€ diagnose_pressure_failure.py
  â”‚   â”‚   â”œâ”€ debug_autograd_issue.py
  â”‚   â”‚   â”œâ”€ debug_derivatives_computation.py
  â”‚   â”‚   â”œâ”€ debug_gradient_computation.py
  â”‚   â”‚   â”œâ”€ debug_physics_residuals.py
  â”‚   â”‚   â”œâ”€ diagnose_conservation_error.py
  â”‚   â”‚   â”œâ”€ diagnose_training_data.py
  â”‚   â”‚   â”œâ”€ diagnose_sensor_overfitting.py
  â”‚   â”‚   â””â”€ ... (å…¶ä»–è¨ºæ–·å·¥å…·)
  â”‚   â”‚
  â”‚   â”œâ”€ validation/               # ç‰©ç†é©—è­‰æ¸¬è©¦ (6 å€‹)
  â”‚   â”‚   â”œâ”€ physics_validation.py
  â”‚   â”‚   â”œâ”€ test_channel_flow_experiment.py
  â”‚   â”‚   â”œâ”€ test_channel_flow_physics.py
  â”‚   â”‚   â”œâ”€ test_conservation_with_model.py
  â”‚   â”‚   â”œâ”€ validate_hybrid_sensors.py
  â”‚   â”‚   â””â”€ validate_ns_conservation.py
  â”‚   â”‚
  â”‚   â””â”€ archive_*/                # æ­¸æª”èˆŠè…³æœ¬ (45 å€‹å·²æ£„ç”¨)
  â”‚       â”œâ”€ archive_demos/        # æ¼”ç¤ºè…³æœ¬ (3)
  â”‚       â”œâ”€ archive_eval/         # éšæ®µæ€§è©•ä¼° (11)
  â”‚       â”œâ”€ archive_monitors/     # éšæ®µæ€§ç›£æ§ (9)
  â”‚       â”œâ”€ archive_sensors/      # æ„Ÿæ¸¬é»ç”Ÿæˆ (10)
  â”‚       â”œâ”€ archive_diagnostics/  # éæ™‚è¨ºæ–· (6)
  â”‚       â””â”€ archive_shell_scripts/ # éæ™‚ Shell (9)
  â”‚
  â”œâ”€ pinnx/                        # æ ¸å¿ƒæ¨¡çµ„
  â”‚   â”œâ”€ __init__.py
  â”‚   â”œâ”€ physics/
  â”‚   â”‚   â”œâ”€ channel_flow_3d.py    # 3D é€šé“æµç‰©ç†
  â”‚   â”‚   â”œâ”€ vs_pinn_channel_flow.py # VS-PINN é€šé“æµï¼ˆå«ç¸®æ”¾ï¼‰
  â”‚   â”‚   â”œâ”€ navier_stokes_3d.py   # é€šç”¨ 3D NS æ–¹ç¨‹
  â”‚   â”‚   â”œâ”€ hit_turbulence.py     # å‡å‹»å„å‘åŒæ€§æ¹æµ
  â”‚   â”‚   â””â”€ ... (å…¶ä»–ç‰©ç†æ¨¡çµ„)
  â”‚   â”‚
  â”‚   â”œâ”€ models/
  â”‚   â”‚   â”œâ”€ fourier_mlp.py        # Fourier feature + sine MLP
  â”‚   â”‚   â”œâ”€ enhanced_fourier_mlp.py # å¢å¼·ç‰ˆ Fourier MLP
  â”‚   â”‚   â””â”€ siren.py              # SIREN æ¨¡å‹
  â”‚   â”‚
  â”‚   â”œâ”€ losses/
  â”‚   â”‚   â”œâ”€ adaptive_weights.py   # è‡ªé©æ‡‰æ¬Šé‡ï¼ˆGradNorm/NTKï¼‰
  â”‚   â”‚   â”œâ”€ curriculum_weights.py # èª²ç¨‹å­¸ç¿’æ¬Šé‡
  â”‚   â”‚   â”œâ”€ physics_residuals.py  # ç‰©ç†æ®˜å·®æå¤±
  â”‚   â”‚   â””â”€ data_losses.py        # è³‡æ–™ä¸€è‡´æ€§æå¤±
  â”‚   â”‚
  â”‚   â”œâ”€ sensors/
  â”‚   â”‚   â””â”€ qr_sampling.py        # QR-pivot æ„Ÿæ¸¬é»é¸æ“‡
  â”‚   â”‚
  â”‚   â”œâ”€ dataio/
  â”‚   â”‚   â”œâ”€ jhtdb_loader.py       # JHTDB è³‡æ–™è¼‰å…¥
  â”‚   â”‚   â”œâ”€ channel_flow_loader.py # é€šé“æµå°ˆç”¨è¼‰å…¥å™¨
  â”‚   â”‚   â””â”€ lowfi_loader.py       # ä½ä¿çœŸè³‡æ–™è¼‰å…¥
  â”‚   â”‚
  â”‚   â”œâ”€ train/                    # è¨“ç·´ç®¡ç†æ¨¡çµ„ â­ [é‡æ§‹å®Œæˆ]
  â”‚   â”‚   â”œâ”€ trainer.py (815 è¡Œ)   # æ ¸å¿ƒè¨“ç·´å™¨é¡åˆ¥
  â”‚   â”‚   â”‚   â””â”€ Trainer: ç®¡ç†å®Œæ•´è¨“ç·´å¾ªç’°ï¼ˆå„ªåŒ–å™¨ã€å‹•æ…‹æ¬Šé‡ã€æª¢æŸ¥é»ã€é©—è­‰ï¼‰
  â”‚   â”‚   â”œâ”€ ensemble.py           # Ensemble è¨“ç·´ + UQ
  â”‚   â”‚   â”œâ”€ loop.py               # è¨“ç·´å¾ªç’°å·¥å…·å‡½æ•¸
  â”‚   â”‚   â”œâ”€ adaptive_collocation.py # è‡ªé©æ‡‰æ¡æ¨£
  â”‚   â”‚   â”œâ”€ checkpointing.py      # æª¢æŸ¥é»ç®¡ç†
  â”‚   â”‚   â”œâ”€ config_loader.py      # é…ç½®è¼‰å…¥å™¨
  â”‚   â”‚   â””â”€ factory.py            # æ¨¡å‹/å„ªåŒ–å™¨å·¥å» 
  â”‚   â”‚
  â”‚   â””â”€ evals/
  â”‚       â”œâ”€ metrics.py            # è©•ä¼°æŒ‡æ¨™
  â”‚       â””â”€ visualizers.py        # è¦–è¦ºåŒ–å·¥å…·
  â”‚
  â”œâ”€ tests/                        # å–®å…ƒæ¸¬è©¦èˆ‡æ•´åˆæ¸¬è©¦
  â”‚   â”œâ”€ test_3d_physics.py        # 3D ç‰©ç†æ¸¬è©¦
  â”‚   â”œâ”€ test_losses.py            # æå¤±å‡½æ•¸æ¸¬è©¦
  â”‚   â”œâ”€ test_models.py            # æ¨¡å‹æ¶æ§‹æ¸¬è©¦
  â”‚   â”œâ”€ test_physics_validation.py # ç‰©ç†é©—è­‰æ¸¬è©¦
  â”‚   â”œâ”€ test_physics.py           # ç‰©ç†æ¨¡çµ„æ¸¬è©¦
  â”‚   â”œâ”€ test_metrics.py           # æŒ‡æ¨™è¨ˆç®—æ¸¬è©¦
  â”‚   â””â”€ ... (å…¶ä»–æ¸¬è©¦)
  â”‚
  â”œâ”€ context/                      # ä¸» Agent æ±ºç­–è¨˜éŒ„
  â”‚   â”œâ”€ context_session_*.md      # æœƒè©±ä¸Šä¸‹æ–‡
  â”‚   â””â”€ decisions_log.md          # æ±ºç­–æ—¥èªŒ
  â”‚
  â”œâ”€ tasks/                        # ä»»å‹™ç®¡ç†
  â”‚   â””â”€ TASK-<id>/               # å„ä»»å‹™ç›®éŒ„
  â”‚       â”œâ”€ task_brief.md         # ä»»å‹™ç°¡è¿°
  â”‚       â”œâ”€ physics_review.md     # ç‰©ç†å¯©æŸ¥
  â”‚       â”œâ”€ impl_plan.md          # å¯¦ä½œè¨ˆç•«
  â”‚       â””â”€ ... (å…¶ä»–ç”¢å‡º)
  â”‚
  â”œâ”€ results/                      # è¨“ç·´çµæœ
  â”œâ”€ log/                          # è¨“ç·´æ—¥èªŒ
  â”œâ”€ checkpoints/                  # æ¨¡å‹æª¢æŸ¥é»
  â”œâ”€ environment.yml               # Conda ç’°å¢ƒ
  â”œâ”€ README.md                     # å°ˆæ¡ˆèªªæ˜
  â”œâ”€ TECHNICAL_DOCUMENTATION.md    # æŠ€è¡“æ–‡æª”
  â””â”€ AGENTS.md                     # é–‹ç™¼è€…æŒ‡å¼•ï¼ˆæœ¬æ–‡æª”ï¼‰
```

è©³è¦‹ `scripts/README.md` ç²å–å®Œæ•´è…³æœ¬ä½¿ç”¨èªªæ˜ã€‚

# ç‰©ç†è¨Šæ¯ç¥ç¶“ç¶²è·¯(PINNs)æ¶æ§‹ã€é‚è¼¯è¨­å®š
- ç¶²è·¯å¤§å°: 8 x 200
- è¼¸å…¥: x, y, z, t, (ä½ç²¾åº¦RANSçµæœ), (fourier feature)
- è¼¸å‡ºï¼šu, v, w, p
- loss termåŸºç¤è¨­ç½®(è©³ç´°ç”±adaptive weightingæ±ºå®š): w_{pde} ç‚ºåŸºæº–è¨­ç‚º1ï¼Œè¦å‰‡ç‚ºw_{data} = w_{boundary} = w_{initial} > w_{pde} 
- æ•¸æ“šé›†ï¼šJHTDB channel flow Re_\tau=1000
- æ•¸æ“šé›†å¤§å°ï¼š128 x 32 x 128
- ä½¿ç”¨å®Œæ•´æ•¸æ“šé›†ä¸­çš„QR pivotingé¸é»ä½œç‚ºç›£ç£è¨“ç·´ï¼Œè¨“ç·´å®Œæˆå¾Œç”¨ä¾†é æ¸¬å®Œæ•´æ•¸æ“šé›†çš„æµå ´èª¤å·®

# JHTDB channel flow Re_\tau=1000è¨­å®š
| é¡åˆ¥        | åƒæ•¸                                                            | æ•¸å€¼ / èªªæ˜                                                                                                                           |
| --------- | ------------------------------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------- |
| å¹¾ä½•/ç¶²æ ¼     | è¨ˆç®—åŸŸ                                                           | (L_x\times L_y\times L_z=8\pi h\times 2h\times 3\pi h)ï¼ˆ(h=1)ï¼‰ã€ã€‘                                                                   |
|           | ç¶²æ ¼ï¼ˆé »åŸŸ/å¯¦åŸŸï¼‰                                                     | (N_x\times N_y\times N_z=2048\times 512\times 1536)ï¼ˆwavemodesï¼‰ï¼›å°æ‡‰ collocation (3072\times 512\times 2304)ï¼›**å„²å­˜**ä»¥ wavemode è§£æåº¦ã€‚ã€ã€‘ |
| æµé«”/å¼·è¿«     | é»æ»¯ä¿‚æ•¸                                                          | (\nu=5\times10^{-5})ï¼ˆç„¡å› æ¬¡ï¼‰ã€‚ã€ã€‘                                                                                                      |
|           | å¹³å‡å£“åŠ›æ¢¯åº¦                                                        | (dP/dx=0.0025)ï¼ˆç„¡å› æ¬¡ï¼‰ã€‚ã€ã€‘                                                                                                            |
| æ™‚é–“        | DNS æ™‚æ­¥ / è³‡æ–™åº«æ™‚æ­¥                                                | (\Delta t=0.0013)ï¼›(\delta t=0.0065)ã€‚ã€ã€‘                                                                                            |
|           | å„²å­˜æ™‚é–“ç¯„åœ                                                        | (t\in[0,,25.9935])ã€‚ã€ã€‘                                                                                                             |
| çµ±è¨ˆé‡       | é«”ç©å¹³å‡ / ä¸­å¿ƒç·š / æ‘©æ“¦é€Ÿåº¦                                             | (U_b=0.99994)ã€(U_c=1.1312)ã€(u_\tau=4.9968\times10^{-2})ã€‚ã€ã€‘                                                                        |
|           | é»é•·å°ºåº¦                                                          | (\delta_\nu=\nu/u_\tau=1.0006\times10^{-3})ã€‚ã€ã€‘                                                                                    |
|           | é›·è«¾æ•¸                                                           | (Re_b=3.9998\times10^4)ï¼Œ(Re_c=2.2625\times10^4)ï¼Œ(Re_\tau=9.9935\times10^2)ã€‚ã€ã€‘                                                     |
| è§£æåº¦ï¼ˆé»é•·å–®ä½ï¼‰ | (\Delta x^+) / (\Delta y_1^+) / (\Delta y_c^+) / (\Delta z^+) | (12.2639) / (1.65199\times10^{-2}) / (6.15507) / (6.13196)ã€‚ã€ã€‘                                                                     |
| å¯«å‡º/ç­†æ•¸     | Frame æ•¸                                                       | é€Ÿåº¦èˆ‡å£“åŠ›æ¯ 5 æ­¥å¯«å‡ºï¼Œå…± **4000** framesã€‚ã€ã€‘                                                                                                 |


# è©•æ¸¬èˆ‡æˆæ•—é–€æª»æª¢æŸ¥

`scripts/evaluate.py` éœ€è¼¸å‡ºï¼š

1. **ç›¸å° L2**ï¼ˆu,v,pï¼‰â‰¤ 10â€“15%ï¼ˆä¾æ¡ˆä¾‹åˆ†å±¤ï¼‰ã€‚
2. ç›¸å°æ–¼ä½ä¿çœŸï¼š**çµ±è¨ˆï¼ˆå‡å€¼/äºŒéšå‹•é‡ï¼‰ã€èƒ½è­œã€å£é¢å‰ªæ‡‰åŠ›** çš„ RMSE ä¸‹é™ â‰¥ 30%ã€‚
3. **Kâ€“èª¤å·®æ›²ç·š**ï¼ˆå°æ¯” QR-pivot ä¸Šç•Œã€éš¨æ©Ÿ/ç­‰è·ä½ˆé»ï¼‰ã€‚

`pinnx/evals/metrics.py` å¯æä¾›ï¼š

* `relative_L2(pred, ref)`
* `spectrum_rmse(pred, ref)`ï¼ˆ1D/2D FFT èƒ½è­œï¼‰
* `wall_shear_stress(u,v)`ï¼ˆé€šé“æˆ–å£é¢æ³•å‘ï¼‰
* `k_curve(exps)`ï¼ˆæƒ K=4..16ï¼Œç•« error vs. Kï¼‰
* `uncertainty_correlation(mean, var, ref)`ï¼ˆvar çš„å¹³æ–¹æ ¹ vs. |err| çš„ç›¸é—œï¼‰

---

# é æœŸå¯¦ç¾å…§å®¹

* **QR-pivot**ï¼šç”¨ä½ä¿çœŸæˆ–æ­·å²å¿«ç…§çŸ©é™£å°±èƒ½æŒ‘ K é»ï¼Œèƒ½ç©©å¥åœ°ç¸®æ¸›æ„Ÿæ¸¬é»éœ€æ±‚
* **VS-PINN + å‹•æ…‹æ¬Šé‡ + å› æœæ¬Šé‡**ï¼šåŒæ™‚æ”¹å–„æ”¶æ–‚èˆ‡å‰›æ€§ï¼Œå°é«˜ Re æˆ–é€†å•é¡Œç©©å®šåº¦å¾ˆé—œéµã€‚
* **è»Ÿå…ˆé©—**ï¼š`prior_consistency` æ¬Šé‡ä¸è¦å¤ªå¤§ï¼ˆé¿å…æŠŠ PINN ç¶æ­»åœ¨ä½ä¿çœŸï¼‰ï¼›å»ºè­° 0.1â€“0.5 åš sweepã€‚
* **æºé …é‚„åŸ**ï¼šå…ˆå¾ç©ºé–“å¹³æ»‘ + L1 ç¨€ç–å•Ÿå‹•ï¼Œè§€å¯Ÿæ®˜å·®åœ–æ¨£å†é€æ­¥æ”¾é¬†æ­£å‰‡ã€‚
* **é‡ç¾æ€§**ï¼šå›ºå®šæ‰€æœ‰ seedï¼Œè³‡æ–™ç®¡ç·šï¼ˆcutout/æ•£é»ï¼‰å­˜æª”ï¼Œé…ç½®å¯«å…¥ `configs/`ã€‚
* **è³‡æ–™æ¨™æº–åŒ–**ï¼šæ¨™æº–åŒ–ç¶²è·¯è¼¸å…¥è¼¸å‡ºï¼Œåˆ©æ–¼è¨“ç·´ç©©å®š
* **å­¸ç¿’ç‡ç­–ç•¥**ï¼šå‰æœŸAdamå¾ŒæœŸL-BFGSï¼Œæ”¶æ–‚æ›´å¿«é€Ÿï¼Œä¸æœƒä¸€ç›´éœ‡ç›ª
* **æ¬Šé‡æ¨™æº–åŒ–ï¼‹è‡ªé©æ‡‰**ï¼šæ¨™æº–åŒ–lossæ¬Šé‡ï¼Œä½¿losså¤§å°ä¿æŒç©©å®šï¼Œä¸¦é€éè‡ªé©æ‡‰èª¿æ•´å„é …æ¬Šé‡
* **å•Ÿå‹•å‡½æ•¸**ï¼šä½¿ç”¨sineå‡½æ•¸ä½œç‚ºactivation functionï¼Œç›¸æ¯”tanhæ›´èƒ½ä¿æŒé«˜éšé …å°æ•¸çš„éˆæ•åº¦
* **èª²ç¨‹å¼å­¸ç¿’**ï¼šä½¿ç”¨éšæ®µå¼å­¸ç¿’ï¼Œé€æ­¥é™ä½å­¸ç¿’ç‡ä»¥åŠæå‡é›·è«¾æ•¸ï¼Œä½¿æ¨¡å‹ç·©æ­¥æ”¶æ–‚æ›´ç‚ºç²¾æº–
* **å‚…ç«‹è‘‰ç‰¹å¾µ**ï¼šå¼•å…¥fourier featureç•¶ä½œè¼¸å…¥ä¹‹ä¸€ï¼Œä½¿æ¨¡å‹å°æ–¼é«˜é »ç‰¹å¾µæ›´ç‚ºæ•æ„Ÿ

---

# è¨“ç·´æ¶æ§‹è¨­è¨ˆ
å°ˆæ¡ˆæ¡ç”¨åˆ†å±¤æ¶æ§‹ï¼Œå°‡è¨“ç·´é‚è¼¯æ¸…æ™°åˆ†é›¢ï¼š

### 1. **è…³æœ¬å±¤** (`scripts/train.py` - 1232 è¡Œ)
**è·è²¬**: è¼•é‡ç´šå”èª¿å™¨èˆ‡å…¥å£é»
- åƒæ•¸è§£æèˆ‡é…ç½®è¼‰å…¥
- è³‡æ–™è¼‰å…¥èˆ‡é è™•ç†å”èª¿
- æ¨¡å‹/ç‰©ç†/æå¤±å‡½æ•¸åˆå§‹åŒ–
- è¨“ç·´å™¨å¯¦ä¾‹åŒ–èˆ‡èª¿ç”¨
- çµæœä¿å­˜èˆ‡æ—¥èªŒç®¡ç†

**é—œéµç‰¹æ€§**:
- ä¸åŒ…å«è¨“ç·´å¾ªç’°é‚è¼¯ï¼ˆå·²ç§»è‡³ `Trainer`ï¼‰
- å°ˆæ³¨æ–¼ã€Œçµ„è£ã€è€Œéã€ŒåŸ·è¡Œã€
- æ”¯æ´å–®æ¨¡å‹èˆ‡ Ensemble å…©ç¨®æ¨¡å¼
- ä¿æŒèˆ‡æ‰€æœ‰ç¾æœ‰ 30+ é…ç½®æª”æ¡ˆçš„å‘å¾Œç›¸å®¹

### 2. **æ ¸å¿ƒè¨“ç·´å™¨** (`pinnx/train/trainer.py` - 815 è¡Œ)
**è·è²¬**: å¯é‡ç”¨çš„è¨“ç·´å¾ªç’°ç®¡ç†
- å–®æ­¥è¨“ç·´ (`step()`)ï¼šå‰å‘å‚³æ’­ã€æå¤±è¨ˆç®—ã€æ¢¯åº¦æ›´æ–°
- é©—è­‰å¾ªç’° (`validate()`)ï¼šè¨ˆç®—é©—è­‰é›†æŒ‡æ¨™
- å®Œæ•´è¨“ç·´ (`train()`)ï¼šepoch å¾ªç’°ã€æ—©åœã€æª¢æŸ¥é»ç®¡ç†
- å‹•æ…‹æ¬Šé‡èª¿åº¦ï¼ˆGradNormã€å› æœæ¬Šé‡ã€èª²ç¨‹å­¸ç¿’ï¼‰
- å­¸ç¿’ç‡èª¿åº¦ï¼ˆAdam â†’ L-BFGS åˆ‡æ›ï¼‰

**é—œéµç‰¹æ€§**:
- è¨­å‚™ç„¡é—œï¼ˆæ”¯æ´ CPU/CUDAï¼‰
- å¯ç¨ç«‹æ¸¬è©¦ï¼ˆå–®å…ƒæ¸¬è©¦å‹å¥½ï¼‰
- æ”¯æ´ VS-PINN èˆ‡æ¨™æº– PINN
- å®Œæ•´çš„è¨“ç·´æ­·å²è¨˜éŒ„

### 3. **å·¥å…·æ¨¡çµ„** (`pinnx/train/`)
- `loop.py`: è¨“ç·´å¾ªç’°å·¥å…·å‡½æ•¸ï¼ˆæ¬Šé‡æ‡‰ç”¨ã€æ®˜å·®è¨ˆç®—ï¼‰
- `adaptive_collocation.py`: è‡ªé©æ‡‰æ¡æ¨£ç­–ç•¥
- `checkpointing.py`: æª¢æŸ¥é»ä¿å­˜/è¼‰å…¥
- `ensemble.py`: Ensemble è¨“ç·´èˆ‡ä¸ç¢ºå®šæ€§é‡åŒ–
- `factory.py`: æ¨¡å‹/å„ªåŒ–å™¨/æå¤±å‡½æ•¸å·¥å» 
- `config_loader.py`: é…ç½®ç®¡ç†èˆ‡é©—è­‰

**ä½¿ç”¨ç¯„ä¾‹**:
```python
# scripts/train.py ä¸­çš„ç°¡åŒ–èª¿ç”¨
from pinnx.train.trainer import Trainer

# åˆå§‹åŒ–è¨“ç·´å™¨
trainer = Trainer(model, physics, losses, config, device)
trainer.training_data = training_data_sample

# åŸ·è¡Œè¨“ç·´ï¼ˆä¸€è¡Œæå®šï¼‰
train_result = trainer.train()
```
---

## ğŸ“¦ é…ç½®æ¨¡æ¿å¿«é€Ÿé–‹å§‹

**æ–°æ‰‹ç”¨æˆ¶**ï¼šæˆ‘å€‘æä¾› 4 å€‹æ¨™æº–åŒ–æ¨¡æ¿ï¼Œæ¶µè“‹å¾å¿«é€Ÿæ¸¬è©¦åˆ°ç”Ÿç”¢è¨“ç·´çš„å®Œæ•´æµç¨‹ã€‚

### **æ¨¡æ¿é¸æ“‡æŒ‡å—**

| å ´æ™¯ | æ¨¡æ¿ | æ™‚é–“ | K é»æ•¸ | Epochs |
|------|------|------|--------|--------|
| **å¿«é€Ÿé©—è­‰æƒ³æ³•** | [`2d_quick_baseline.yml`](configs/templates/2d_quick_baseline.yml) | 5-10 min | 50 | 100 |
| **ç‰¹å¾µæ¶ˆèç ”ç©¶** | [`2d_medium_ablation.yml`](configs/templates/2d_medium_ablation.yml) | 15-30 min | 100 | 1000 |
| **èª²ç¨‹å¼è¨“ç·´** | [`3d_slab_curriculum.yml`](configs/templates/3d_slab_curriculum.yml) | 30-60 min | 100 | 1000 |
| **è«–æ–‡ç´šçµæœ** | [`3d_full_production.yml`](configs/templates/3d_full_production.yml) | 2-8 hrs | 500 | 5000 |

ğŸ‘‰ **å®Œæ•´æ¨¡æ¿æ–‡æª”**ï¼š[`configs/templates/README.md`](configs/templates/README.md)

### **å¿«é€Ÿä½¿ç”¨ç¯„ä¾‹**

```bash
# 1. è¤‡è£½æ¨¡æ¿åˆ° configs/ ç›®éŒ„
cp configs/templates/2d_quick_baseline.yml configs/my_experiment.yml

# 2. ä¿®æ”¹å¿…è¦åƒæ•¸ï¼ˆå¯¦é©—åç¨±ã€è¼¸å‡ºè·¯å¾‘ï¼‰
vim configs/my_experiment.yml

# 3. åŸ·è¡Œè¨“ç·´
python scripts/train.py --cfg configs/my_experiment.yml

# 4. ç›£æ§è¨“ç·´é€²åº¦
tail -f log/my_experiment/training.log
```

**å¿…æ”¹åƒæ•¸**ï¼š
- `experiment.name`: æ”¹ç‚ºä½ çš„å¯¦é©—åç¨±ï¼ˆå¦‚ `my_ablation_fourier_v1`ï¼‰
- `output.checkpoint_dir`: æ”¹ç‚ºå°æ‡‰è·¯å¾‘ï¼ˆå¦‚ `./checkpoints/my_ablation_fourier_v1`ï¼‰
- `output.results_dir`: æ”¹ç‚ºå°æ‡‰è·¯å¾‘ï¼ˆå¦‚ `./results/my_ablation_fourier_v1`ï¼‰

**é…ç½®å‘½åè¦ç¯„**ï¼šåƒè¦‹ [`configs/README.md`](configs/README.md#-é…ç½®å‘½åè¦ç¯„)

---

## ğŸš€ è¨“ç·´è…³æœ¬ä½¿ç”¨æ–¹å¼

### **åŸºæœ¬è¨“ç·´æŒ‡ä»¤**
```bash
# åŸºæœ¬è¨“ç·´ï¼ˆä½¿ç”¨é…ç½®æ–‡ä»¶ï¼‰
python scripts/train.py --cfg configs/<config_name>.yml

# Ensemble è¨“ç·´ï¼ˆä¸ç¢ºå®šæ€§é‡åŒ–ï¼‰
python scripts/train.py --cfg configs/<config_name>.yml --ensemble

# å¾æª¢æŸ¥é»æ¢å¾©è¨“ç·´
python scripts/train.py --cfg configs/<config_name>.yml --resume checkpoints/<exp_name>/epoch_X.pth
```

### **å‘½ä»¤è¡Œåƒæ•¸èªªæ˜**
| åƒæ•¸ | é¡å‹ | é è¨­å€¼ | èªªæ˜ |
|------|------|--------|------|
| `--cfg` | str | `configs/defaults.yml` | é…ç½®æ–‡ä»¶è·¯å¾‘ |
| `--ensemble` | flag | False | å•Ÿç”¨ Ensemble è¨“ç·´ |
| `--resume` | str | None | å¾æª¢æŸ¥é»æ¢å¾©è¨“ç·´çš„è·¯å¾‘ |

### **é…ç½®æ–‡ä»¶å¿…è¦æ¬„ä½**

#### 1. **è¼¸å‡ºè·¯å¾‘é…ç½®** (å¿…é ˆåœ¨ YAML ä¸­å®šç¾©)
```yaml
output:
  checkpoint_dir: "./checkpoints/<experiment_name>"  # æª¢æŸ¥é»ä¿å­˜ä½ç½®
  results_dir: "./results/<experiment_name>"         # çµæœè¼¸å‡ºä½ç½®
  visualization_dir: "./results/<experiment_name>/visualizations"  # è¦–è¦ºåŒ–è¼¸å‡º

logging:
  level: "info"              # æ—¥èªŒç­‰ç´š: debug/info/warning/error
  log_freq: 10              # æ—¥èªŒè¼¸å‡ºé »ç‡ï¼ˆæ¯ N å€‹ epochï¼‰
  save_predictions: true    # æ˜¯å¦ä¿å­˜é æ¸¬çµæœ
  tensorboard: true         # å•Ÿç”¨ TensorBoard
  wandb: false              # å•Ÿç”¨ Weights & Biasesï¼ˆé¸ç”¨ï¼‰
```

#### 2. **å¯¦é©—åŸºæœ¬è¨­å®š**
```yaml
experiment:
  name: "<experiment_name>"  # å¯¦é©—åç¨±ï¼ˆç”¨æ–¼æ—¥èªŒè­˜åˆ¥ï¼‰
  version: "v1.0"           # ç‰ˆæœ¬è™Ÿ
  seed: 42                  # éš¨æ©Ÿç¨®å­ï¼ˆå¯é‡ç¾æ€§ï¼‰
  device: "auto"            # è¨­å‚™ï¼šauto/cpu/cuda/cuda:0
  precision: "float32"      # ç²¾åº¦ï¼šfloat32/float64
  description: "å¯¦é©—æè¿°"   # å¯¦é©—èªªæ˜ï¼ˆé¸ç”¨ï¼‰
```

#### 3. **è¨“ç·´è¨­å®š**
```yaml
training:
  optimizer: "adam"         # å„ªåŒ–å™¨ï¼šadam/lbfgs/sgd
  lr: 1.0e-3               # å­¸ç¿’ç‡
  epochs: 1000             # è¨“ç·´è¼ªæ•¸
  batch_size: 1024         # æ‰¹æ¬¡å¤§å°
  checkpoint_freq: 100     # æª¢æŸ¥é»ä¿å­˜é »ç‡
  log_interval: 10         # æ—¥èªŒè¼¸å‡ºé–“éš”
  validation_freq: 50      # é©—è­‰é »ç‡
```

### **å¯¦éš›ä½¿ç”¨ç¯„ä¾‹**

#### å¿«é€Ÿæ¸¬è©¦ï¼ˆ100 epochsï¼‰
```bash
python scripts/train.py --cfg configs/test_rans_quick.yml
```

#### å®Œæ•´è¨“ç·´ï¼ˆ1000+ epochsï¼‰
```bash
# å‰å°é‹è¡Œ
python scripts/train.py --cfg configs/test_physics_fix_1k.yml

# èƒŒæ™¯é‹è¡Œï¼ˆæ¨è–¦ï¼‰
nohup python scripts/train.py --cfg configs/test_physics_fix_1k.yml \
    > log/<exp_name>/training_stdout.log 2>&1 &
```

#### ç›£æ§è¨“ç·´é€²åº¦
```bash
# å³æ™‚ç›£æ§è¨“ç·´æ—¥èªŒ
tail -f log/<exp_name>/training.log

# ç›£æ§æ¨™æº–è¼¸å‡º
tail -f log/<exp_name>/training_stdout.log

# ä½¿ç”¨ç›£æ§è…³æœ¬ï¼ˆå¦‚æœæœ‰ï¼‰
./scripts/monitor_curriculum.sh
```

### **âš ï¸ å¸¸è¦‹éŒ¯èª¤èˆ‡ä¿®æ­£**

| éŒ¯èª¤é¡å‹ | éŒ¯èª¤åŸå›  | æ­£ç¢ºæ–¹å¼ |
|---------|---------|---------|
| âŒ `--log_dir` | ä¸å­˜åœ¨çš„åƒæ•¸ | âœ… åœ¨ YAML ä¸­é…ç½® `output.checkpoint_dir` |
| âŒ `--checkpoint` | ä¸å­˜åœ¨çš„åƒæ•¸ | âœ… ä½¿ç”¨ `--resume <path>` |
| âŒ `--name` | ä¸å­˜åœ¨çš„åƒæ•¸ | âœ… åœ¨ YAML ä¸­é…ç½® `experiment.name` |
| âŒ ç›´æ¥ä¿®æ”¹ `train.py` | ç ´å£å¯ç¶­è­·æ€§ | âœ… é€šé YAML é…ç½®æ‰€æœ‰åƒæ•¸ |
| âŒ ç¡¬ç·¨ç¢¼è·¯å¾‘ | ä¸åˆ©æ–¼è¤‡ç”¨ | âœ… ä½¿ç”¨ç›¸å°è·¯å¾‘ä¸¦éµå¾ªç›®éŒ„è¦ç¯„ |

### **ç›®éŒ„çµæ§‹è¦ç¯„**
```
å¯¦é©—åç¨±å»ºè­°æ ¼å¼: test_<feature>_<variant>_<epochs>
ç¯„ä¾‹: test_rans_phase6c_v3

å°æ‡‰ç›®éŒ„çµæ§‹:
â”œâ”€â”€ configs/test_rans_phase6c_v3.yml          # é…ç½®æ–‡ä»¶
â”œâ”€â”€ checkpoints/test_rans_phase6c_v3/         # æª¢æŸ¥é»è¼¸å‡º
â”‚   â”œâ”€â”€ epoch_100.pth
â”‚   â”œâ”€â”€ best_model.pth
â”‚   â””â”€â”€ latest.pth
â”œâ”€â”€ results/test_rans_phase6c_v3/             # çµæœè¼¸å‡º
â”‚   â”œâ”€â”€ metrics.json
â”‚   â”œâ”€â”€ predictions.npz
â”‚   â””â”€â”€ visualizations/                       # è¦–è¦ºåŒ–åœ–è¡¨
â””â”€â”€ log/test_rans_phase6c_v3/                 # æ—¥èªŒæ–‡ä»¶ï¼ˆå¯é¸ï¼‰
    â”œâ”€â”€ training.log
    â””â”€â”€ training_stdout.log
```

### **æª¢æŸ¥é»ç®¡ç†**
```bash
# å¾ç‰¹å®š epoch æ¢å¾©
python scripts/train.py --cfg configs/my_exp.yml --resume checkpoints/my_exp/epoch_500.pth

# å¾æœ€ä½³æ¨¡å‹æ¢å¾©ï¼ˆwarm startï¼‰
python scripts/train.py --cfg configs/phase2.yml --resume checkpoints/phase1/best_model.pth

# å¾æœ€æ–°æª¢æŸ¥é»æ¢å¾©
python scripts/train.py --cfg configs/my_exp.yml --resume checkpoints/my_exp/latest.pth
```

---
